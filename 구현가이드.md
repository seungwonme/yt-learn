# YouTube 학습 플랫폼 만들기

> AI와 함께 코딩 없이 만드는 학습 플랫폼 (2025년 최신 버전)

## 시작하기 전에

이 가이드는 **AI 어시스턴트(Claude, ChatGPT 등)** 와 함께 YouTube 학습 플랫폼을 만드는 방법입니다.
프로그래밍 지식이 없어도 AI에게 요청하는 방식으로 따라할 수 있습니다.

### 필요한 것

1. **터미널 (명령창)** - 맥의 터미널 또는 윈도우의 PowerShell
2. **AI 어시스턴트** - Claude Code, ChatGPT, Cursor 등
3. **API 키** - 나중에 발급받을 예정

---

## 📦 1단계: 프로젝트 초기 설정

### 1-1. UI 라이브러리 설치

터미널에서 실행:
```bash
pnpm dlx shadcn@latest init -d
```

**결과**: 예쁜 UI 컴포넌트들이 자동으로 설치됩니다.

### 1-2. 필요한 도구들 설치

터미널에서 실행:
```bash
pnpm add @google/generative-ai @danielxceron/youtube-transcript react-youtube react-icons next-themes zod
```

**결과**: YouTube와 AI 기능을 사용하기 위한 도구들이 설치됩니다.

> 💡 **2025년 업데이트**: `youtube-transcript` 대신 `@danielxceron/youtube-transcript`를 사용합니다.
> 이유: HTML 스크래핑 실패 시 YouTube InnerTube API로 자동 전환되어 더 안정적입니다.

### 1-3. 폴더 구조 만들기

터미널에서 실행:
```bash
mkdir -p src/app/video/[videoId] \
  src/app/api/youtube/search \
  src/app/api/youtube/captions \
  src/app/api/ai/summarize \
  src/components/search \
  src/components/video \
  src/components/theme \
  src/lib/youtube \
  src/lib/ai \
  src/types
```

**결과**: 프로젝트에 필요한 폴더들이 생성됩니다.

### 1-4. AI에게 요청하기

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
.env.example 파일을 만들어줘.
YouTube API 키와 Gemini API 키를 입력할 수 있게 해줘.
```

**원하는 결과**:
- API 키를 저장할 예제 파일이 생성됨
- 각 항목에 어디서 발급받는지 설명이 포함됨
</details>

### 1-5. AI에게 요청하기

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/types/index.ts 파일을 만들어줘.
YouTube 영상 정보, 자막, AI 요약에 필요한 타입들을 정의해줘.
```

**원하는 결과**:
- 프로젝트 전체에서 사용할 데이터 형식이 정의됨
</details>

### 1-6. AI에게 요청하기

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
1. src/components/theme/ThemeProvider.tsx 만들어줘
   다크모드/라이트모드 전환 기능

2. src/app/layout.tsx 수정해줘
   - ThemeProvider 추가
   - 제목을 "YouTube 학습 플랫폼"으로 변경
   - 한국어로 설정
```

**원하는 결과**:
- 다크모드/라이트모드 지원
- 웹사이트 제목 변경
</details>

### 1-7. AI에게 요청하기

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
next.config.ts 수정해줘.
YouTube 이미지를 불러올 수 있도록 설정해줘.
(i.ytimg.com, yt3.ggpht.com)
```

**원하는 결과**:
- YouTube 썸네일 이미지가 웹사이트에 표시됨
</details>

---

## 🎥 2단계: YouTube 기능 만들기

### 2-1. AI에게 요청하기

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/lib/youtube/api.ts 파일을 만들어줘.

기능:
- YouTube에서 영상 검색
- 환경 변수에서 API 키 가져오기
- 검색 결과를 우리가 사용하기 쉬운 형태로 변환

참고 문서: https://developers.google.com/youtube/v3/docs/search/list
```

**원하는 결과**:
- YouTube 검색 기능 완성
</details>

### 2-2. AI에게 요청하기 ⚠️ 중요 업데이트

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/lib/youtube/captions.ts 파일을 만들어줘.

기능:
- YouTube 영상에서 자막 추출
- 한국어 우선, 없으면 영어 자막
- @danielxceron/youtube-transcript 라이브러리 사용
  (원본보다 안정적, InnerTube API 폴백 기능 내장)

중요:
- offset과 duration은 밀리초(ms) 단위로 반환됨
- 초(seconds)로 변환하려면 1000으로 나눠야 함
  예: start: item.offset / 1000

참고: npm에서 @danielxceron/youtube-transcript 문서 확인
```

**원하는 결과**:
- 영상 자막 추출 기능 완성
- 타임스탬프가 올바르게 표시됨
</details>

### 2-3. AI에게 요청하기

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/app/api/youtube/search/route.ts 만들어줘.

기능:
- 검색어를 받아서 YouTube 검색 실행
- 잘못된 입력은 걸러내기 (zod 사용)
- 에러 발생 시 적절한 메시지 반환

입력: 검색어, 최대 결과 수(선택)
출력: 영상 목록, 다음 페이지 토큰

⚠️ 중요 (Zod 4.x):
- error.errors 대신 error.issues 사용
  예: error.issues.map(e => e.message)
```

**원하는 결과**:
- 검색 API 완성
- 웹사이트에서 `/api/youtube/search?q=검색어` 로 검색 가능
</details>

### 2-4. AI에게 요청하기

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/app/api/youtube/captions/route.ts 만들어줘.

기능:
- 영상 ID를 받아서 자막 추출
- 자막이 없으면 적절한 메시지 반환

입력: 영상 ID, 언어(선택, 기본값 한국어)
출력: 자막 목록, 언어, 사용 가능 여부

⚠️ 중요 (Zod 4.x):
- error.errors 대신 error.issues 사용
```

**원하는 결과**:
- 자막 추출 API 완성
</details>

---

## 🎨 3단계: 메인 페이지 만들기

### 3-1. AI에게 요청하기

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/components/search/SearchBar.tsx 만들어줘.

기능:
- 검색어 입력창
- 검색 버튼 (돋보기 아이콘)
- 로딩 중일 때 버튼 비활성화
- shadcn/ui Input, Button 사용
```

**원하는 결과**:
- 깔끔한 검색창 완성
</details>

### 3-2. AI에게 요청하기

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/components/video/VideoCard.tsx 만들어줘.

기능:
- 영상 썸네일, 제목, 채널명, 설명 표시
- 클릭하면 영상 상세 페이지로 이동
- hover 시 애니메이션 효과
- shadcn/ui Card 사용
```

**원하는 결과**:
- 예쁜 영상 카드 완성
</details>

### 3-3. AI에게 요청하기 ⚠️ UI 컴포넌트 변경

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/components/search/SearchResults.tsx 만들어줘.

상태별 화면:
- 로딩 중: 스켈레톤 UI
- 에러 발생: 에러 메시지
- 결과 없음: "검색 결과가 없습니다"
- 검색 전: "YouTube 영상을 검색해보세요"
- 결과 있음: 그리드 형태로 VideoCard 표시 (반응형)

⚠️ 중요 (Empty 컴포넌트 사용법):
Empty 컴포넌트는 서브 컴포넌트를 children으로 받습니다.

올바른 사용법:
<Empty>
  <EmptyHeader>
    <EmptyTitle>제목</EmptyTitle>
    <EmptyDescription>설명</EmptyDescription>
  </EmptyHeader>
</Empty>

잘못된 사용법 (사용 금지):
<Empty title="제목" description="설명" />
```

**원하는 결과**:
- 모든 상태를 처리하는 검색 결과 화면 완성
</details>

### 3-4. AI에게 요청하기 🆕 검색 상태 유지

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/app/page.tsx 수정해줘.

구조:
- 상단: 제목, 설명, 검색창
- 하단: 검색 결과

기능:
- 검색 버튼 클릭 시 API 호출
- 로딩, 에러, 결과 상태 관리

🆕 새로운 기능 - 검색 상태 유지:
- sessionStorage에 검색 결과 저장
- 비디오 페이지에서 뒤로가기 시 검색 결과 복원
- 페이지 새로고침 시에도 검색 결과 유지 (탭 닫기 전까지)

구현 방법:
1. 검색 성공 시: sessionStorage.setItem('youtube_search_state', JSON.stringify({ query, videos }))
2. 페이지 로드 시: useEffect로 sessionStorage에서 복원
3. Suspense 경고 방지: useSearchParams 대신 sessionStorage 사용
```

**원하는 결과**:
- 완전히 동작하는 메인 페이지 완성
- 뒤로가기 시 검색 결과 유지
</details>

---

## 📺 4단계: 영상 상세 페이지 만들기

### 4-1. AI에게 요청하기

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/components/video/VideoPlayer.tsx 만들어줘.

기능:
- YouTube 영상 재생
- react-youtube 라이브러리 사용
- 현재 재생 시간 추적
- 반응형 크기 조절

참고: react-youtube npm 문서
```

**원하는 결과**:
- YouTube 영상 플레이어 완성
</details>

### 4-2. AI에게 요청하기 🆕 자막 복사 기능

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/components/video/CaptionViewer.tsx 만들어줘.

기능:
- 자막 목록 표시
- 현재 재생 중인 자막 하이라이트
- 자막 클릭 시 해당 시간으로 이동
- 스크롤 가능

🆕 새로운 기능 - 자막 복사:
- CardHeader에 "자막 복사" 버튼 추가
- 버튼 클릭 시 모든 자막 텍스트를 클립보드에 복사
- 복사 완료 시 "복사됨" 피드백 표시 (2초 후 원래대로)
- react-icons/lu에서 LuCopy, LuCheck 아이콘 사용

구현:
- navigator.clipboard.writeText() 사용
- 자막 배열을 \n으로 연결하여 복사
```

**원하는 결과**:
- 자막 뷰어 완성
- 클립보드에 자막 복사 기능
</details>

### 4-3. AI에게 요청하기 ⚠️ UI 컴포넌트 변경

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/components/video/SummarySection.tsx 만들어줘.

화면 구성:
- 전체 요약
- 핵심 포인트 (불릿 리스트)
- 주요 타임스탬프 (클릭 가능)

상태:
- 로딩 중: 스켈레톤
- 에러: 에러 메시지
- 요약 없음: "AI 요약이 생성되지 않았습니다. 상단의 'AI 요약 생성' 버튼을 클릭해주세요"
- 완료: 요약 내용 표시

아이콘:
- react-icons/lu에서 LuCircleCheck, LuClock 사용

⚠️ 중요 (Empty 컴포넌트 사용법):
Empty 컴포넌트는 서브 컴포넌트를 children으로 받습니다.

올바른 사용법:
<Empty>
  <EmptyHeader>
    <EmptyTitle>AI 요약이 생성되지 않았습니다</EmptyTitle>
    <EmptyDescription>
      상단의 &apos;AI 요약 생성&apos; 버튼을 클릭해주세요
    </EmptyDescription>
  </EmptyHeader>
</Empty>

주의: 작은따옴표는 &apos;로 이스케이프 처리
```

**원하는 결과**:
- AI 요약 표시 섹션 완성
</details>

---

## 🤖 5단계: AI 요약 기능 만들기

### 5-1. AI에게 요청하기

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/lib/ai/gemini.ts 만들어줘.

기능:
- Google Gemini API 사용
- 자막을 받아서 요약 생성
- JSON 형식으로 응답 받기 (전체 요약, 핵심 포인트, 타임스탬프)
- 자막이 너무 길면 자동으로 잘라내기

참고: @google/generative-ai npm 문서
```

**원하는 결과**:
- Gemini AI 연동 완성
</details>

### 5-2. AI에게 요청하기 ⚠️ Zod 4.x 호환성

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/app/api/ai/summarize/route.ts 만들어줘.

기능:
- 자막과 영상 제목을 받아서 AI 요약 생성
- POST 요청 처리
- 입력 검증

입력: 자막, 영상 제목
출력: AI 요약 결과

⚠️ 중요 (Zod 4.x):
- error.errors 대신 error.issues 사용
  예: error.issues.map(e => e.message)
```

**원하는 결과**:
- AI 요약 API 완성
</details>

---

## 🎬 6단계: 모든 기능 연결하기

### 6-1. AI에게 요청하기

<details>
<summary>💬 AI에게 이렇게 말하세요</summary>

```
src/app/video/[videoId]/page.tsx 만들어줘.

페이지 구조:
- 상단: 뒤로가기 버튼
- 왼쪽 (2/3): 영상 플레이어 + 자막
- 오른쪽 (1/3): AI 요약 생성 버튼 + AI 요약

기능 흐름:
1. 페이지 로드 시 자막 자동 추출
2. 자막 로딩 중: 스켈레톤 UI 표시
3. 자막 추출 완료: 자막 표시 + "AI 요약 생성" 버튼 표시
4. 버튼 클릭 시 AI 요약 생성 (자동 생성 안 함)
5. 플레이어와 자막 동기화
6. 타임스탬프 클릭 시 해당 시간으로 이동

추가 기능:
- AI 요약 재생성 버튼 (요약 생성 후 표시)
- 로딩 상태 명확하게 표시
- 에러 상태 Card로 감싸서 표시

반응형:
- PC: 좌우 분할
- 모바일: 위아래로 배치

아이콘:
- react-icons/lu에서 LuArrowLeft, LuRefreshCw 사용
```

**원하는 결과**:
- 완전한 영상 상세 페이지 완성
- 모든 기능 연동
- 자막 로딩 상태 표시
- AI 요약 수동 생성 버튼
</details>

---

## 🔑 API 키 발급하기

### YouTube Data API

1. https://console.cloud.google.com/apis/credentials 접속
2. "프로젝트 만들기" 클릭
3. "사용자 인증 정보" → "API 키" 생성
4. YouTube Data API v3 활성화
5. API 키 복사

### Google Gemini API

1. https://makersuite.google.com/app/apikey 접속
2. "API 키 만들기" 클릭
3. API 키 복사

### API 키 설정

1. 프로젝트 폴더에 `.env.local` 파일 생성
2. 내용 입력:
```
YOUTUBE_API_KEY=여기에_유튜브_API_키_붙여넣기
GOOGLE_GEMINI_API_KEY=여기에_제미나이_API_키_붙여넣기
YOUTUBE_MAX_RESULTS=10
```

---

## 🚀 실행하기

### 개발 서버 시작

터미널에서:
```bash
pnpm dev
```

브라우저에서 `http://localhost:3000` 접속

### 작동 확인

1. ✅ 검색창에 키워드 입력 → 영상 목록 표시
2. ✅ 영상 클릭 → 상세 페이지 이동
3. ✅ 영상 재생
4. ✅ 자막 로딩 → 자막 표시
5. ✅ "자막 복사" 버튼으로 자막 복사
6. ✅ "AI 요약 생성" 버튼 클릭 → AI 요약 생성
7. ✅ 자막 클릭 → 해당 시간으로 이동
8. ✅ 타임스탬프 클릭 → 해당 위치로 이동
9. ✅ "AI 요약 재생성" 버튼으로 재생성 가능
10. ✅ 뒤로가기 시 검색 결과 유지

---

## 🔄 주요 개선사항

### v2.0 업데이트 (2025년 최신)

**자막 라이브러리 교체** 🔥
- ✅ `youtube-transcript` → `@danielxceron/youtube-transcript`
- ✅ InnerTube API 자동 폴백으로 안정성 대폭 향상
- ✅ HTML 스크래핑 실패 시 자동 전환
- ✅ 타임스탬프 밀리초 변환 문제 해결

**Zod 4.x 호환성**
- ✅ `error.errors` → `error.issues` 변경
- ✅ 모든 API 라우트에 반영

**검색 상태 유지** 🆕
- ✅ sessionStorage로 검색 결과 저장
- ✅ 뒤로가기 시 검색 결과 자동 복원
- ✅ Next.js 15 Suspense 요구사항 충족

**자막 복사 기능** 🆕
- ✅ 클립보드에 자막 텍스트 복사
- ✅ 복사 완료 피드백 표시

**UI 컴포넌트 구조 변경**
- ✅ Empty 컴포넌트 올바른 사용법 적용
- ✅ 서브 컴포넌트 패턴으로 변경

### v1.1 업데이트

**자막 로딩 UI 개선**
- ✅ 자막 추출 중 스켈레톤 UI 표시
- ✅ 로딩 메시지로 사용자에게 진행 상황 알림
- ✅ 에러 상태를 Card로 감싸서 더 명확하게 표시

**AI 요약 사용성 개선**
- ✅ 자동 생성 제거 → 수동 생성으로 변경
- ✅ "AI 요약 생성" 버튼 추가
- ✅ "AI 요약 재생성" 버튼으로 언제든 재생성 가능
- ✅ 로딩 중 회전 아이콘으로 진행 상황 표시

**아이콘 수정**
- ✅ react-icons/lu의 올바른 아이콘 사용 (LuCircleCheck, LuClock)

---

## 🛠️ 문제 해결 가이드

### 자막 타임스탬프가 0:00으로 표시될 때

**원인**: `@danielxceron/youtube-transcript`는 offset과 duration을 밀리초로 반환

**해결**:
```typescript
// ✅ 올바른 코드
const captions = transcriptItems.map((item) => ({
  text: item.text,
  start: item.offset / 1000,    // ms -> seconds
  duration: item.duration / 1000 // ms -> seconds
}));

// ❌ 잘못된 코드
const captions = transcriptItems.map((item) => ({
  text: item.text,
  start: item.offset,  // 밀리초 그대로 사용 -> 잘못된 시간
  duration: item.duration
}));
```

### Zod 에러: "error.errors does not exist"

**원인**: Zod 4.x에서 `errors` 프로퍼티가 `issues`로 변경됨

**해결**:
```typescript
// ✅ 올바른 코드 (Zod 4.x)
if (error instanceof z.ZodError) {
  const errorMessage = error.issues.map(e => e.message).join(", ");
}

// ❌ 잘못된 코드 (Zod 3.x)
if (error instanceof z.ZodError) {
  const errorMessage = error.errors.map(e => e.message).join(", ");
}
```

### Next.js: "useSearchParams should be wrapped in suspense"

**원인**: Next.js 15에서 useSearchParams를 Suspense로 감싸야 함

**해결**: sessionStorage를 사용하여 Suspense 없이 구현
```typescript
// ✅ 권장: sessionStorage 사용
useEffect(() => {
  const savedState = sessionStorage.getItem('youtube_search_state');
  if (savedState) {
    const { query, videos } = JSON.parse(savedState);
    setSearchQuery(query);
    setVideos(videos);
  }
}, []);
```

---

## 📝 자주 묻는 질문

<details>
<summary>Q: 에러가 발생하면 어떻게 하나요?</summary>

**A**: AI에게 에러 메시지를 보여주고 이렇게 말하세요:
```
이런 에러가 발생했어:
[에러 메시지 복사]

2025년 최신 방법으로 문제를 찾아서 고쳐줘.
```
</details>

<details>
<summary>Q: 디자인을 바꾸고 싶어요</summary>

**A**: AI에게 구체적으로 요청하세요:
```
메인 페이지의 [바꾸고 싶은 부분]을 [어떻게] 바꿔줘.
예: "메인 페이지의 제목 색상을 파란색으로 바꿔줘"
```
</details>

<details>
<summary>Q: 새로운 기능을 추가하고 싶어요</summary>

**A**: AI에게 원하는 기능을 설명하세요:
```
[어떤 기능]을 추가해줘.
기존 코드에 영향을 주지 않게 해줘.
예: "영상 저장 기능을 추가해줘"
```
</details>

<details>
<summary>Q: 자막이 제대로 추출되지 않아요</summary>

**A**: 2025년 최신 라이브러리로 업데이트하세요:
```
@danielxceron/youtube-transcript로 변경해줘.
이유: InnerTube API 폴백 기능이 있어서 더 안정적이야.

기존 youtube-transcript를 제거하고
@danielxceron/youtube-transcript를 설치한 후
src/lib/youtube/captions.ts를 업데이트해줘.
```
</details>

---

## 🎯 다음 단계

프로젝트가 완성되었습니다! 이제 다음을 시도해보세요:

- ⭐ **개선하기**: 검색 필터, 즐겨찾기, 시청 기록 등
- 🌍 **배포하기**: Vercel, Netlify 등에 배포
- 📱 **모바일 최적화**: 터치 제스처, 네이티브 앱처럼 만들기
- 🎨 **커스터마이징**: 나만의 디자인으로 변경
- 🔊 **음성 요약**: TTS 기능 추가
- 📚 **학습 노트**: 요약을 저장하고 관리하는 기능

---

## 💡 팁

1. **AI에게 명확하게 요청하기**
   - ❌ "페이지 만들어줘"
   - ✅ "검색 페이지를 만들어줘. 검색창과 결과 목록이 필요해"

2. **한 번에 하나씩**
   - 한 번에 여러 기능을 요청하지 말고, 하나씩 완성하기

3. **참고 문서 활용**
   - AI에게 공식 문서 링크를 함께 제공하면 더 정확함
   - 2025년 최신 방법을 요청하기

4. **테스트하며 진행**
   - 각 단계마다 `pnpm dev`로 실행해서 확인하기

5. **에러 발생 시**
   - 에러 메시지 전체를 AI에게 복사해서 보내기
   - "2025년 최신 방법으로 해결해줘"라고 요청하기

---

**완성된 프로젝트 구조**

```
learning-yt/
├── src/
│   ├── app/              # 페이지들
│   │   ├── page.tsx      # 메인 (검색 상태 유지)
│   │   ├── layout.tsx    # 레이아웃
│   │   ├── video/        # 영상 상세
│   │   └── api/          # API 라우트
│   ├── components/       # 재사용 가능한 UI
│   │   ├── search/       # 검색 관련
│   │   ├── video/        # 영상 관련 (자막 복사 포함)
│   │   └── theme/        # 테마 관련
│   ├── lib/              # 핵심 기능
│   │   ├── youtube/      # YouTube API (2025년 최신)
│   │   └── ai/           # Gemini AI
│   └── types/            # 데이터 형식
├── .env.local            # API 키 (비밀!)
└── package.json          # 프로젝트 정보
```

## 🎉 축하합니다!

이제 나만의 YouTube 학습 플랫폼을 만들었습니다!

**주요 기능**:
- ✅ YouTube 영상 검색
- ✅ 자막 자동 추출 (InnerTube API 폴백)
- ✅ 자막 복사 기능
- ✅ AI 요약 생성 (수동)
- ✅ 타임스탬프 네비게이션
- ✅ 검색 상태 유지
- ✅ 다크모드 지원
- ✅ 완전 반응형

**2025년 최신 기술 스택**:
- Next.js 15
- @danielxceron/youtube-transcript (InnerTube API)
- Zod 4.x
- Google Gemini AI
- shadcn/ui

---

**문의사항이나 개선 아이디어가 있으신가요?**

AI에게 물어보세요! 이 가이드를 바탕으로 더 멋진 기능을 추가할 수 있습니다. 🚀
